# ğŸŒ¿ HERB Scraper í”„ë¡œì íŠ¸

---

## ğŸ“Œ **í”„ë¡œì íŠ¸ ê°œìš”**  
**herb-scraper**ëŠ” HERB ë°ì´í„°ë² ì´ìŠ¤ì™€ TCMSP (Traditional Chinese Medicine Systems Pharmacology) ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ í•œì•½ì¬ ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ í¬ë¡¤ë§í•˜ê³  ì „ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” Python ê¸°ë°˜ì˜ ìŠ¤í¬ë˜í¼ì…ë‹ˆë‹¤.  

âœ… **ë°ì´í„° ìˆ˜ì§‘ íë¦„:**  
- **ì§€í™©:** HERB ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í†µí•´ `herb_scraper.py` â†’ `ingredient_scraper.py`ë¡œ í¬ë¡¤ë§í•©ë‹ˆë‹¤.  
- **ê¸°íƒ€ ì•½ì¬:** TCMSP ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í†µí•´ `tcmsp_scraper.py`ë¡œ í¬ë¡¤ë§í•©ë‹ˆë‹¤.  

ì´ í”„ë¡œì íŠ¸ëŠ” ì—°êµ¬ì ë° ê°œë°œìê°€ ë¹ ë¥´ê²Œ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ê³  í•„í„°ë§í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ ì•½ë¦¬í•™ ì—°êµ¬ì— í™œìš©í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•©ë‹ˆë‹¤.

---

## âœ… **ì£¼ìš” ê¸°ëŠ¥:**  
1. **HERB & TCMSP ë°ì´í„° í¬ë¡¤ë§**: ì§€í™© ë° ê¸°íƒ€ í•œì•½ì¬ì˜ ì„±ë¶„ê³¼ íƒ€ê²Ÿ ì •ë³´ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤.  
2. **ë°ì´í„° ì „ì²˜ë¦¬(í•„í„°ë§)**: OB(ê²½êµ¬ì´ìš©ë¥ )ì™€ DL(ì•½ë¬¼ ìœ ì‚¬ì„±) ê¸°ì¤€ìœ¼ë¡œ ì„±ë¶„ê³¼ íƒ€ê²Ÿ ë°ì´í„°ë¥¼ í•„í„°ë§í•©ë‹ˆë‹¤.  
3. **ë‹¤ì–‘í•œ í¬ë§· ì§€ì›**: í¬ë¡¤ë§ ë° í•„í„°ë§ëœ ë°ì´í„°ë¥¼ JSON, CSV, Excel íŒŒì¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.  
4. **ì‚¬ìš©ì ì¹œí™”ì  ì„¤ì •**: `config/settings.py`ì—ì„œ ë°ì´í„° ê²½ë¡œ ë° í•„í„°ë§ ì„ê³„ê°’ì„ ì†ì‰½ê²Œ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  

---

## ğŸ—‚ï¸ **ë””ë ‰í† ë¦¬ êµ¬ì¡°**
```bash
herb-scraper/
â”œâ”€â”€ README.md                          # âœ… í”„ë¡œì íŠ¸ ì„¤ëª… ë¬¸ì„œ
â”œâ”€â”€ requirements.txt                   # âœ… Python íŒ¨í‚¤ì§€ ëª©ë¡
â”œâ”€â”€ venv/                              # âœ… ê°€ìƒí™˜ê²½ ë””ë ‰í† ë¦¬
â”‚
â”œâ”€â”€ config/                            # âš™ï¸ ì„¤ì • ê´€ë ¨
â”‚   â””â”€â”€ settings.py                    # í™˜ê²½ ì„¤ì • (ê²½ë¡œ, í•„í„°ë§ ì„ê³„ê°’ ë“±)
â”‚
â”œâ”€â”€ modules/                           # ğŸ§© ì½”ë“œ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ data_utils.py                  # ğŸŒ ë°ì´í„° ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸° ë° WebDriver ì„¤ì •
â”‚   â”œâ”€â”€ logger.py                      # ğŸ“ ë¡œê·¸ ê¸°ë¡ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ herb_utils.py                  # ğŸŒ± HERB ë°ì´í„° í¬ë¡¤ë§ ëª¨ë“ˆ
â”‚   â””â”€â”€ tcmsp_utils.py                 # ğŸŒ TCMSP ë°ì´í„° í¬ë¡¤ë§ ëª¨ë“ˆ
â”‚
â”œâ”€â”€ preprocess/                        # ğŸ§¹ ì „ì²˜ë¦¬ ê´€ë ¨
â”‚   â””â”€â”€ tcmsp_process.py               # TCMSP ë°ì´í„° í•„í„°ë§
â”‚
â”œâ”€â”€ scripts/                           # ğŸš€ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ herb_scraper.py                # ğŸŒ¿ ì§€í™© ì„±ë¶„ URL í¬ë¡¤ë§ ìŠ¤í¬ë¦½íŠ¸ (HERB ì „ìš©)
â”‚   â”œâ”€â”€ ingredient_scraper.py         # ğŸ§ª ì§€í™© ì„±ë¶„ ìƒì„¸ ì •ë³´ í¬ë¡¤ë§ ìŠ¤í¬ë¦½íŠ¸
â”‚   â””â”€â”€ tcmsp_scraper.py               # ğŸª´ ê¸°íƒ€ í•œì•½ì¬ TCMSP í¬ë¡¤ë§ ìŠ¤í¬ë¦½íŠ¸
â”‚
â””â”€â”€ data/                              # ğŸ“‚ ë°ì´í„° ì €ì¥
    â””â”€â”€ herb/                          # ğŸ“¥ ì§€í™© ë°ì´í„° (HERB ì›ë³¸ ë° ìƒì„¸ ì •ë³´)
    â””â”€â”€ tcmsp/                         # ğŸ“¥ ê¸°íƒ€ ì•½ì¬ TCMSP ë°ì´í„°
```

---
## ğŸ—ºï¸ **ğŸ“Š íŒŒì´í”„ë¼ì¸ íë¦„ë„**
```mermaid
graph TD
    subgraph ì§€í™© (HERB ë°ì´í„°)
        A[herb_scraper.py: ì§€í™© ì„±ë¶„ URL ìˆ˜ì§‘] --> B[herb_ingredient_urls_ì§€í™©.json ì €ì¥]
        B --> C[ingredient_scraper.py: ì§€í™© ì„±ë¶„ ìƒì„¸ í¬ë¡¤ë§]
        C --> D[JSON, CSV, XLSXë¡œ ì €ì¥ (data/herb/)]
    end

    subgraph ê¸°íƒ€ ì•½ì¬ (TCMSP ë°ì´í„°)
        E[tcmsp_scraper.py: ê¸°íƒ€ í•œì•½ì¬ ì„±ë¶„ ë° íƒ€ê²Ÿ í¬ë¡¤ë§] --> F[JSON, CSV ì €ì¥ (data/tcmsp/)]
    end

    subgraph ì „ì²˜ë¦¬ ë° ë¶„ì„
        D --> G[tcmsp_process.py: ë°ì´í„° í•„í„°ë§]
        F --> G
        G --> H[í•„í„°ë§ëœ Excel ë°ì´í„° ìƒì„± (data/tcmsp/)]
    end
```


---

## ğŸ› ï¸ **ì„¤ì¹˜ ë° ì‹¤í–‰ ë°©ë²•**
### 1ï¸âƒ£ ê°€ìƒí™˜ê²½ ì„¤ì •
```bash
python -m venv venv
source venv/bin/activate      # Mac/Linux
venv\Scripts\activate        # Windows
pip install -r requirements.txt
```

### 2ï¸âƒ£ í¬ë¡¤ë§ ë° ë°ì´í„° ìˆ˜ì§‘

#### ğŸŒ¿ **ì§€í™© (HERB ë°ì´í„°)**
##### ğŸ“ (1ë‹¨ê³„) ì„±ë¶„ URL í¬ë¡¤ë§
```bash
python scripts/herb_scraper.py
```
- **ì„¤ëª…**: HERB ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì§€í™©ì˜ ì„±ë¶„ URLì„ ìˆ˜ì§‘í•©ë‹ˆë‹¤.
- **ì¶œë ¥ íŒŒì¼**: `data/herb/herb_ingredient_urls_ì§€í™©.json`

##### ğŸ§ª (2ë‹¨ê³„) ì„±ë¶„ ìƒì„¸ ì •ë³´ í¬ë¡¤ë§
```bash
python scripts/ingredient_scraper.py
```
- **ì„¤ëª…**: ìˆ˜ì§‘í•œ URLì„ ê¸°ë°˜ìœ¼ë¡œ ê° ì„±ë¶„ì˜ ìƒì„¸ ì •ë³´ë¥¼ í¬ë¡¤ë§í•©ë‹ˆë‹¤.
- **ì¶œë ¥ íŒŒì¼**: `data/herb/herb_ingredients_ì§€í™©.json`, `.csv`, `.xlsx`

---

#### ğŸª´ **ê¸°íƒ€ ì²­ì—´ì•½(í™©ê¸ˆ, í™©ë ¨, í™©ë°±, ê³ ì‚¼, ì§€ëª¨, ì§€í™©, ì¹˜ì) (TCMSP ë°ì´í„°)**
##### ğŸŒ ì„±ë¶„ ë° íƒ€ê²Ÿ í¬ë¡¤ë§
```bash
python scripts/tcmsp_scraper.py
```
- **ì„¤ëª…**: TCMSP ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì§€í™©ì„ ì œì™¸í•œ ì²­ì—´ì•½ì˜ ì„±ë¶„ ë° íƒ€ê²Ÿ ì •ë³´ë¥¼ í¬ë¡¤ë§í•©ë‹ˆë‹¤.
- **ì¶œë ¥ íŒŒì¼**: `data/tcmsp/` í´ë” ë‚´ JSON ë° CSV íŒŒì¼

---

### 3ï¸âƒ£ ë°ì´í„° ì „ì²˜ë¦¬ ë° í•„í„°ë§
```bash
python preprocess/tcmsp_process.py
```
- **ì„¤ëª…**: HERBì™€ TCMSPì—ì„œ ìˆ˜ì§‘ëœ ë°ì´í„°ë¥¼ OB ë° DL ê¸°ì¤€ìœ¼ë¡œ í•„í„°ë§í•©ë‹ˆë‹¤.
- **ì¶œë ¥ íŒŒì¼**: `data/tcmsp/tcmsp_filtered_targets_ì „ì²´_ì•½ì¬.xlsx`
- **ì„ê³„ê°’ ì¡°ì •**: `config/settings.py`ì˜ `OB_THRESHOLD` ë° `DL_THRESHOLD` ë³€ê²½ ê°€ëŠ¥

---
## âš™ï¸ ì„¤ì • ì„¤ëª… (`config/settings.py`)

```markdown
| ì„¤ì • ë³€ìˆ˜              | ì„¤ëª…                             | ê¸°ë³¸ê°’    |
|-----------------------|----------------------------------|---------|
| `OB_THRESHOLD`        | OB(ê²½êµ¬ì´ìš©ë¥ ) í•„í„°ë§ ì„ê³„ê°’     | `30`    |
| `DL_THRESHOLD`        | DL(ì•½ë¬¼ ìœ ì‚¬ì„±) í•„í„°ë§ ì„ê³„ê°’    | `0.18`  |
| `HERB_GROUP_NAME`     | ë°ì´í„° ê·¸ë£¹ ì´ë¦„                | `ì „ì²´_ì•½ì¬` |
| `RAW_DATA_PATH`       | í¬ë¡¤ë§ ì›ë³¸ ë°ì´í„° ê²½ë¡œ         | ìë™ ì„¤ì • |
| `PROCESSED_EXCEL_PATH`| í•„í„°ë§ ë°ì´í„° Excel ì €ì¥ ê²½ë¡œ   | ìë™ ì„¤ì • |
```

---

## ğŸ“Š **ì¶œë ¥ ë°ì´í„° ì˜ˆì‹œ**

### âœ… **ì§€í™© (HERB) ë°ì´í„° ì˜ˆì‹œ**
#### 1ï¸âƒ£ **ì„±ë¶„ URL í¬ë¡¤ë§ ê²°ê³¼** (`herb_ingredient_urls_ì§€í™©.json`)
```json
{
  "ì§€í™©": [
    "http://herb.ac.cn/Detail/?v=HBIN000001",
    "http://herb.ac.cn/Detail/?v=HBIN000002"
  ]
}
```

#### 2ï¸âƒ£ **ì„±ë¶„ ìƒì„¸ ì •ë³´ í¬ë¡¤ë§ ê²°ê³¼** (`herb_ingredients_ì§€í™©.json`)
```json
{
  "http://herb.ac.cn/Detail/?v=HBIN000001": {
    "ingredient_name": "catalpol",
    "molecule_smile": "C1COC2C(C1)C(O)C(O)C(O)C2O",
    "PubChem ID": "CID12345",
    "CAS ID": "2415-24-9"
  }
}
```

---

### âœ… **ê¸°íƒ€ ì•½ì¬ (TCMSP) ë°ì´í„° ì˜ˆì‹œ**
#### 1ï¸âƒ£ **ì„±ë¶„ ë° íƒ€ê²Ÿ í¬ë¡¤ë§ ê²°ê³¼** (`tcmsp_raw_results_ì „ì²´_ì•½ì¬.json`)
```json
{
  "í™©ê¸ˆ": {
    "ingredients": [
      {
        "mol_id": "MOL000173",
        "mol_name": "baicalin",
        "ob": 41.15,
        "dl": 0.75,
        "mol_url": "https://tcmsp-e.com/..."
      }
    ],
    "targets": [
      {
        "mol_id": "MOL000173",
        "target_name": "EGFR",
        "drugbank_id": "DB00001"
      }
    ]
  }
}
```

#### 2ï¸âƒ£ **í•„í„°ë§ëœ ë°ì´í„°** (`tcmsp_filtered_targets_ì „ì²´_ì•½ì¬.xlsx`)
```markdown
| mol_id     | mol_name | ob    | dl    | target_name | drugbank_id |
|------------|----------|-------|-------|-------------|-------------|
| MOL000173  | baicalin | 41.15 | 0.75  | EGFR        | DB00001     |
```

---

## ğŸ§© **ì£¼ìš” ì½”ë“œ ì„¤ëª…**
```markdown
### ğŸ“ `modules/`
- **`data_utils.py`**: ë°ì´í„° ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸° ë° WebDriver ì„¤ì •.
- **`logger.py`**: ë¡œê·¸ ê¸°ë¡ ëª¨ë“ˆ.
- **`herb_utils.py`**: HERB ë°ì´í„° í¬ë¡¤ë§ ëª¨ë“ˆ (ì§€í™© ì „ìš©).
- **`tcmsp_utils.py`**: TCMSP ë°ì´í„° í¬ë¡¤ë§ ëª¨ë“ˆ (ê¸°íƒ€ ì•½ì¬ ì „ìš©).

### ğŸ“ `scripts/`
- **`herb_scraper.py`**: ì§€í™© ì„±ë¶„ URL í¬ë¡¤ë§.
- **`ingredient_scraper.py`**: ì§€í™© ì„±ë¶„ ìƒì„¸ í¬ë¡¤ë§ ë° ë°ì´í„° ì €ì¥.
- **`tcmsp_scraper.py`**: ê¸°íƒ€ í•œì•½ì¬ í¬ë¡¤ë§.

### ğŸ“ `preprocess/`
- **`tcmsp_process.py`**: ë°ì´í„° ì „ì²˜ë¦¬ ë° í•„í„°ë§.
```

---

## ğŸ“œ **ë¼ì´ì„ ìŠ¤**  
MIT License  
Â© 2025 ìƒì§€í•œì˜ í•™ìˆ ì œ  

---

## ğŸ‘©â€ğŸ’» **ê°œë°œì ì •ë³´**
- **í”„ë¡œì íŠ¸ ë‹´ë‹¹**: ì„œê°•ëŒ€í•™êµ êµ­ì–´êµ­ë¬¸í•™ê³¼ ê¹€í˜„ì„œ  
- **ğŸ“§ ì´ë©”ì¼**: neulbokim@sogang.ac.kr  
- **ğŸŒ GitHub**: [github.com/neulbokim](https://github.com/neulbokim)  

---